% Generated by roxygen2: do not edit by hand
% Please edit documentation in R/dataset-coco.R
\name{coco_dataset}
\alias{coco_dataset}
\alias{coco_detection_dataset}
\alias{coco_caption_dataset}
\title{COCO Detection Dataset}
\usage{
coco_detection_dataset(
  root,
  train = TRUE,
  year = c("2017", "2016", "2014"),
  download = FALSE,
  transforms = NULL,
  target_transform = NULL
)

coco_caption_dataset(root, train = TRUE, year = c("2014"), download = FALSE)
}
\arguments{
\item{root}{Root directory where the dataset is stored or will be downloaded to.}

\item{train}{Logical. If TRUE, loads the training split; otherwise, loads the validation split.}

\item{year}{Character. Dataset version year. One of \code{"2014"}, \code{"2016"}, or \code{"2017"}.}

\item{download}{Logical. If TRUE, downloads the dataset if it's not already present in the \code{root} directory.}

\item{transforms}{Optional transform function applied to the image.}

\item{target_transform}{Optional transform function applied to the target (labels, boxes, etc.).}
}
\value{
A torch dataset. Each example is a list with two elements:

\describe{
\item{x}{A 3D \code{torch_tensor} of shape \code{(C, H, W)} representing the image.}
\item{y}{A list containing:
\describe{
\item{boxes}{A 2D \code{torch_tensor} of shape \code{(N, 4)} containing bounding boxes
in the format c(\eqn{x_{min}}, \eqn{y_{min}}, \eqn{x_{max}}, \eqn{y_{max}}).}
\item{labels}{A 1D \code{torch_tensor} of type integer, representing the class label for each object.}
\item{area}{A 1D \code{torch_tensor} of type float, indicating the area of each object.}
\item{iscrowd}{A 1D \code{torch_tensor} of type boolean, where \code{TRUE} indicates the object is part of a crowd.}
\item{segmentation}{A list of segmentation polygons for each object.}
}
}
}
}
\description{
Loads the MS COCO dataset for object detection and segmentation.

Loads the MS COCO dataset for image captioning.
}
\details{
The returned image is in CHW format (channels, height, width), matching the torch convention.
The dataset \code{y} offers object detection annotations such as bounding boxes, labels,
areas, crowd indicators, and segmentation masks from the official COCO annotations.
}
\examples{
\dontrun{
ds <- coco_detection_dataset(
  root = "~/data",
  train = FALSE,
  year = "2017",
  download = TRUE
)

example <- ds[1]
x <- example$x
y <- example$y

x_uint8 <- x$mul(255)$clamp(0, 255)$to(dtype = torch::torch_uint8())
boxes <- y$boxes
label_ids <- as.integer(torch::as_array(y$labels))
label_names <- ds$category_names[as.character(label_ids)]

output <- draw_bounding_boxes(
  image = x_uint8,
  boxes = boxes,
  labels = label_names
)

tensor_image_browse(output)
}

\dontrun{
ds <- coco_dataset(
  root = "~/data",
  train = FALSE,
  download = TRUE
)
example <- ds[1]

# Access image and caption
x <- example$x
y <- example$y

# Prepare image for plotting
image_array <- as.numeric(x)
dim(image_array) <- dim(x)

plot(as.raster(image_array))
title(main = y, col.main = "black")
}
}
