% Generated by roxygen2: do not edit by hand
% Please edit documentation in R/dataset-caltech.R
\name{caltech101_detection_dataset}
\alias{caltech101_detection_dataset}
\title{Caltech-101 Dataset}
\usage{
caltech101_detection_dataset(
  root = tempdir(),
  transform = NULL,
  target_transform = NULL,
  download = FALSE
)
}
\arguments{
\item{root}{Character. Root directory for dataset storage. The dataset will be stored under \code{root/caltech-101}.}

\item{transform}{Optional function to transform input images after loading. Default is \code{NULL}.}

\item{target_transform}{Optional function to transform labels. Default is \code{NULL}.}

\item{download}{Logical. Whether to download the dataset if not found locally. Default is \code{FALSE}.}
}
\value{
A torch dataset. Each item is a list with two elements:
\describe{
\item{x}{A 3D \code{torch_tensor} of shape \code{(H, W, C)} representing the image in RGB format.}
\item{y}{A list with:
\describe{
\item{boxes}{A 2D \code{torch_tensor} of shape \code{(1, 4)} containing the bounding box in \code{xywh} format.}
\item{labels}{A character scalar giving the class label for the image.}
\item{contour}{A 2D \code{torch_tensor} of shape \code{(N, 2)} with the object contour coordinates.}
}
}
}
}
\description{
Caltech-101 Detection Dataset
}
\details{
Loads the Caltech-101 dataset for object detection, including image-level labels, bounding boxes, and object contours.
The dataset contains images of varying sizes across 101 object categories.
}
\examples{
\dontrun{
caltech101 <- caltech101_detection_dataset(download = TRUE)
first_item <- caltech101[1]

first_item$x <- torch_tensor(first_item$x, dtype = torch::torch_uint8())

# Draw bounding box
bboxes <- draw_bounding_boxes(
  image = first_item$x,
  boxes = first_item$y$boxes,
  labels = caltech101$classes[first_item$y$labels],
  colors = "red"
)
tensor_image_browse(bboxes)

# Draw contour points as keypoints
contour_points <- draw_keypoints(
  image = first_item$x,
  keypoints = first_item$y$contour,
  colors = "green",
  radius = 2
)
tensor_image_browse(contour_points)
}

}
